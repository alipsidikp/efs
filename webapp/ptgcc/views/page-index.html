<script src="/res/js/page-formula.js"></script>
<script src="/res/plugins/eclookup/eclookup.js"></script>
<link rel="stylesheet" href="/res/plugins/eclookup/eclookup.css" />

<!-- main area -->
<div class="col-xs-12 col-sm-12" id="content" data-bind="with: FormulaPage">
	<div class="col-md-12" data-bind="visible: (app.section() == 'formula')">
		<h1>Formula Editor</h1>
		<div class="panel" data-bind="visible: (app.mode() == '')">
		    <div class="panel-body table-formula">
		    	<div class="col-md-12">
		    		<button class="btn btn-sm btn-primary" data-bind="click:fp.addColumn"><span class="glyphicon glyphicon-plus"></span> Add Column</button>
		    	</div>
		    	<div class="col-md-12">
		    		<table id="tableFormula" class="table table-striped table-bordered">
		    			<thead>
			    			<tr>
			    				<td></td>
			    				<td></td>
			    				<td></td>
			    				<td indexid="1"><div class="searchversion"><input class='searchversion' id="version1" /></div></td>
			    			</tr>
			    		</thead>
			    		<tbody data-bind="template:{name:'formulaTemplate', foreach:fp.dataFormula().Element}">
			    		</tbody>
		    		</table>
		    	</div>
		    </div>
		</div>
	</div>
</div>

<script id="formulaTemplate" type="text/html">
	<tr data-bind="click: function(){fp.showFormula($index(),$data)}">
		<td data-bind="html:$index()+1"></td>
		<td data-bind="html:Title1, style: {fontWeight: Bold == true ? 'bold':'normal'}"></td>
		<td data-bind="html:Title2, style: {fontWeight: Bold == true ? 'bold':'normal'}"></td>
		<!-- ko if: Type == 50 || Type == 1 -->
		<td data-bind="html:ValueNum.toString(), style: {fontWeight: Bold == true ? 'bold':'normal'}"></td>
		<!-- /ko -->
		<!-- ko if: Type == 12 || Type == 11 -->
		<td>
			<input type="text" class="form-control input-sm" data-bind="value:ValueTxt"/>
		</td>
		<!-- /ko -->
		<!-- ko if: Type == 10 -->
		<td>
			<input data-bind="attr:{'id':'valueversion'+$index()}"/>
		</td>
		<!-- /ko -->
		<!-- ko foreach: fp.dataVersion -->
			<!-- ko if: Type == 50 || Type == 1 -->
			<td data-bind="html:ValueNum.toString(), style: {fontWeight: Bold == true ? 'bold':'normal'}"></td>
			<!-- /ko -->
			<!-- ko if: Type == 12 -->
			<td>
				<input type="text" class="form-control input-sm" data-bind="value:ValueTxt"/>
			</td>
			<!-- /ko -->
			<!-- ko if: Type == 11 -->
			<td>
				<input data-bind="attr:{'id':'valueversion'+$index()}, kendoNumericTextBox:{value:ValueNum}"/>
			</td>
			<!-- /ko -->
			<!-- ko if: Type == 10 -->
			<td>
				<input data-bind="attr:{'id':'valueversion'+$index()}, kendoDateTimePicker:{value:ValueTxt, format: 'dd MMM yyyy'}"/>
			</td>
			<!-- /ko -->
		<!-- /ko -->
	</tr>
</script>

<div class="modal fade" id="formula-popup" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Formula</h4>
      </div>
      <div class="modal-body">
        <div class="row form-formula">
        	<div class="col-md-4 nav-command">
        		<label class="col-md-12 title-command">List Akun</label>
        		<div class="col-md-12">
        			<ul class="nav" data-bind="foreach: fp.dataFormula().Element">
        				<li><a href="#" data-bind="click: function(){fp.selectListAkun($index(),$data)}, text: ($index()+1)+'. '+Title1+' '+Title2"></a></li>
        			</ul>
        		</div>
        	</div>
        	<div class="col-md-8">
	        	<label class="col-md-12 title-command">Formula Editor</label>
	        	<div class="col-md-12 formula-command">
	        		<div class="btn-group btnKoefisien" role="group" aria-label="...">
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien('+')}">+</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien('-')}">-</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien('*')}">*</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien('/')}">/</button>
					</div>
					<div class="btn-group btnKoefisien" role="group" aria-label="...">
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien('(')}">(</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisien(')')}">)</button>
					</div>
					<div class="btn-group btnKoefisien" role="group" aria-label="...">
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisienGroup('SUM')}">SUM</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisienGroup('AVERAGE')}">AVG</button>
						<button type="button" class="btn btn-primary btn-sm" data-bind="click: function(){fp.selectKoefisienGroup('IF')}">IF</button>
					</div>
					<button class="btn btn-primary btnKoefisien btn-sm" data-bind="click: fp.clearFormula"><span class="glyphicon glyphicon-erase"></span></button>
	        	</div>
	        	<div class="col-md-12 area-editor">
	        		<input id="kostanta" data-bind="kendoNumericTextBox:{value:fp.konstanta, placeholder: 'Konstanta'}"/>
	        	</div>
	        	<div class="col-md-12 area-editor">
	        		<input type="text" id="formula-editor" />
	        	</div>
        	</div>
        </div>
        <div style="clear:both;"></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">OK</button>
      </div>

    </div>
  </div>
</div>